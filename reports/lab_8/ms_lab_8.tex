% !TEX options=--shell-escape
\documentclass[12pt]{article}
\input{packages.tex}
\input{borders.tex}
\renewcommand{\baselinestretch}{1.4} 
\newcommand{\RNumb}[1]{\uppercase\expandafter{\romannumeral #1\relax}}

\begin{document}
\input{title_page.tex}
\input{commands.tex}


\tableofcontents
\addtocontents{toc}{~\hfill\par}
\vfill ~
\setcounter{section}{0}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage 
\section*{Постановка задачи}
\addcontentsline{toc}{section}{Постановка задачи}


\indent{\indentРассматриваются методы интервальных оценок характеристик распределения. Требуется сгенерировать выборки объемами $n = 20, \; 100$ элементов для нормального распределения $N(x; 0, 1)$, затем для параметров положения и масштаба построить асимптотически нормальные интервальные оценки на основе точечных оценок метода максимального правдоподобия. Также необходимо оценить параметры распределения на основе статистик $\chi^2$ и Стьюдента. В качестве параметра надежности взять $\gamma = 0.95$.}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Описание алгоритма}
\addcontentsline{toc}{section}{Описание алгоритма}
\subsection*{Оценка на основе статистик Стьюдента и хи-квадрат}
\indent{\indent Пусть $x_1, \ldots, x_n$ –– заданная выборка из нормального распределения $N(x; \mu, \sigma)$, по которой требуется оценить параметры $\mu$, $\sigma$, генерального распределения. Построим на ее основе выборочные среднее $\overline{x}$ и среднее квадратическое отклонение $s$. Параметры распределения $\mu, \; \sigma$ не известны. В источнике \cite{ms_1} показано, что статистика Стьюдента}

\begin{equation}
	T = \sqrt{n - 1}\;\frac{\overline{x} - \mu}{s}
	\label{eq_8:1}
\end{equation}
распределена по закону Стьюдента с $n - 1$ степенями свободы. Пусть $f_T(x)$ –– плотность вероятности данного распределения. Тогда

\begin{equation}
    \begin{aligned}        
        P(-x < \sqrt{n - 1} \; \frac{\overline{x} - \mu}{s} < x) = P(-x < \sqrt{n - 1} \; \frac{\mu - \overline{x}}{s} < x) = \\
        =\int_{-x}^{x}f_T(t)dt = 2 F_T(x) - 1 \; ,
        \label{eq_8:2}
\end{aligned}
\end{equation}
где $F_T(t)$ –– функция распределения Стьюдента с $n - 1$ степенями свободы.
\indent{ Положим $2 F_T(x) - 1 = 1 - \alpha$, где $\alpha$ –– выбранный уровень значимости. Тогда $F_T(x) = 1 - {\alpha}/{2}$. Положим $t_{1- {\alpha}/{2}}(n - 1)$ –– квантиль распределения Стьюдента с $n - 1$ степенями свободы и уровнем значимости $1 - {\alpha}/{2}$. Из \eqref{eq_8:1}, \eqref{eq_8:2} получаем}


\begin{equation}
        P\left(\overline{x} - \frac{s t_{1 - {\alpha}/{2}}(n-1)}{\sqrt{n - 1}} < \mu < \overline{x} + \frac{s t_{1 - {\alpha}/{2}}(n-1)}{\sqrt{n - 1}}\right) = 1 - \alpha \; ,
	\label{eq_8:3}
\end{equation}
что дает доверительный интервал для $\mu$ с вероятностью $\gamma = 1 - \alpha$

\indent{ Для поиска оценки параметра $\sigma$ воспользуемся источником \cite{ms_1}, где показано, что случайная величина $n {s^2}/{\sigma^2}$ распределена по закону $\chi^2$ с $n - 1$ степенями свободы. }
\indent{ Найдем квантили $\chi_{{\alpha}/{2}}^2(n - 1), \;\; \chi_{1 - {\alpha}/{2}}^2(n - 1)$ и приведем выражение для доверительного интервала для $\sigma$ с доверительной вероятностью $\gamma = 1 - \alpha$}

\begin{equation}
    P\left(\frac{s \sqrt{n}}{\sqrt{\chi_{1 - {\alpha}/{2}}^2(n - 1)}} < \sigma < \frac{s \sqrt{n}}{\sqrt{\chi_{ {\alpha}/{2}}^2(n - 1)}} \right) = 1 - \alpha
    \label{eq_8:4}
\end{equation}
\subsection*{Асимптотический подход при построении оценок}
\indent{\indent Данный метод оценивания параметров применяется в случае неизвестности закона распределения, или когда он не является нормальным. Асимптотический метод построения доверительных интервалов основан на центральный предельной теореме.}

\indent{ Пусть $\overline{x}$ –– выборочное среднее из выборки большого объема $n$ независимых одинаково распределенных случайных величин. Тогда в силу центральной предельной теоремы случайная величина $(\overline{x} - M\overline{x})/ \sqrt{D\overline{x}} = \sqrt{n}(\overline{x} - \mu)/ \sigma$ распределена приблизительно нормально с параметрами 0, 1. Из данных рассуждений получим выражение для доверительного интервала для $\mu$ с доверительной вероятностью $\gamma = 1 - \alpha$}
\begin{equation}
    P\left(\overline{x} - \frac{su_{1 - \alpha / 2}}{\sqrt{n}} < \mu < \overline{x} + \frac{su_{1 - \alpha / 2}}{\sqrt{n}} \right) \approx \gamma \; , 
    \label{eq_8:5}
\end{equation}
где $u_{1 - \alpha / 2}$ –– квантиль распределения $N(0, 1)$ порядка $1 - \alpha / 2$

\indent{ Приведем выражение для доверительного интервала для $\sigma$ с доверительной вероятностью $\gamma = 1 - \alpha$}
\begin{equation}
    s\left(1 - 0.5U\right) < \sigma < s\left(1 + 0.5U\right) \; , 
    \label{eq_8:6}
\end{equation}
где $U = u_{1 - \alpha / 2} \sqrt{(e + 2) / n}$;  $e$ –– выборочный эксцесс; $m_4$ –– четвертый выборочный центральный момент.

\indent{ Формулы \eqref{eq_8:1} –– \eqref{eq_8:6} и определения взяты из источника \cite{ms_1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Реализация}
\addcontentsline{toc}{section}{Реализация}
\indent{\indentДля выполнения поставленной задачи будем пользоваться библиотеками для языка Python: \textit{numpy, scipy} -- расчеты, законы распределения вероятностей; \textit{matplotlib, seaborn} -- визуализация результатов. Ход работы:}
\begin{itemize}
    \item Генерируем выборки из распределения $N(0, 1)$ объемами $n = 20, \; 100$
    \item Вычисляем выборочные среднее, дисперсию, четвертый центральный момент, эксцесс по приведенным ниже формулам
        \begin{equation}
            \overline{x} = \frac{1}{n} \sum_{i=1}^{n} x_i
            \label{eq_8:7}
        \end{equation}
        \begin{equation}
            s^2 = \frac{1}{n} \sum_{i=1}^{n} (x_i - \overline{x})^2
            \label{eq_8:8}
        \end{equation}
        \begin{equation}
            m_4 = \frac{1}{n} \sum_{i=1}^{n} (x_i - \overline{x})^4
            \label{eq_8:9}
        \end{equation}
        \begin{equation}
            e = \frac{m_4}{s^4} - 3 
            \label{eq_8:10}
        \end{equation}
    \item Вычисляем границы доверительных интервалов по формулам \eqref{eq_8:3}, \eqref{eq_8:4}, \eqref{eq_8:5}, \eqref{eq_8:6}

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\section*{Результат}
\addcontentsline{toc}{section}{Результат}

\indent{Представим табулированные значения квантилей распределений необходимых порядков, $\alpha = 0.05$}
    \begin{itemize}
        \item $t_{0.95}(19) = 1.72, \; t_{0.95}(99) = 1.66$ –– квантили распределения Стьюдента
        \item $\chi^2_{0.025}(19) = 8.91, \; \chi^2_{0.975}(19) = 32.85, \; \chi^2_{0.025}(99) = 73.12, \; \chi^2_{0.975}(99) = 128.4$ –– квантили распределения хи-квадрат
        \item $u_{0.975} = 1.96$ –– квантиль стандартного нормального распределения
    \end{itemize}
\vspace{1cm}
\begin{center}
    \begin{tabular}{ | c | c | c | c |}
        \hline
        $n$ & Интервал для $\mu$ & Интервал для $\sigma$ \\ \hline
        $20$ & $(-0.239; 0.686)$ & $(0.891; 1.711)$  \\ \hline
        $100$ & $(-0.067; 0.266)$ & $(0.876; 1.160)$  \\ \hline
    \end{tabular}
    \captionof{table}{Таблица оценок на основе статистик Стьюдента и хи-квадрат}
\end{center}

\begin{center}
    \begin{tabular}{ | c | c | c | c |}
        \hline
        $n$ & Интервал для $\mu$ & Интервал для $\sigma$ \\ \hline
        $20$ & $(-0.290; 0.737)$ & $(0.873; 1.471)$  \\ \hline
        $100$ & $(-0.096; 0.295)$ & $(0.868; 1.126)$  \\ \hline
    \end{tabular}
    \captionof{table}{Таблица оценок на основе на основе асимптотического подхода}
\end{center}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Вывод}
\addcontentsline{toc}{section}{Вывод}

\indent{\indent По полученным результатам можно судить о том, что асимптотический подход не имеет преимущества по обоим параметрам сразу в случае малой выборки ($n  = 20$) при условиях, что закон распределения известен и является нормальным. При объеме выборки $n  = 100$ можно заметить сокращение длин доверительных интервалов ($0.333 < 0.391$ для $\mu$, $0.258 < 0.284$ для $\sigma$), что является преимуществом асимптотического подхода в оценке параметров распределения.}

\indent{ Недостатком интервальных оценок на основе статистик Стьюдента и хи-квадрат может выступать сложность получения точечных оценок параметра распределения, если оно не является нормальным, что в с свою очередь усложнит вычисления.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\begin{thebibliography}{}
    \bibitem{ms_1}\textit{Амосова Н.Н., Куклин Б.А., Макарова С.Б., Максимов Ю.Д., Митрофанова Н.М., Полищук В.И., Шевляков Г.Л.} Вероятностные разделы математики. Учебник для бакалавров технических направлений. –– СПб.: Иван Федоров, 2001. –– 592 с.: илл. — ISBN 5-81940-050-X.
\end{thebibliography}


\end{document}{}